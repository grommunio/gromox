.\" SPDX-License-Identifier: CC-BY-SA-4.0 or-later
.\" SPDX-FileCopyrightText: 2024â€“2025 grommunio GmbH
.TH gromox\-export 8 "" "Gromox" "Gromox admin reference"
.SH Name
gromox\-export \(em Utility to export Gromox messages to various formats
.SH Synopsis
\fBgromox\-exm2eml \-u\fP \fIuser@domain.example\fP
[\fIfolder_id\fP\fB:\fP]\fImessage_id\fP
.PP
\fBgromox\-exm2ical \-u\fP \fIuser@domain.example\fP
[\fIfolder_id\fP\fB:\fP]\fImessage_id\fP
.PP
\fBgromox\-exm2vcf \-u\fP \fIuser@domain.example\fP
[\fIfolder_id\fP\fB:\fP]\fImessage_id\fP
.PP
\fBgromox\-exm2mt \-u\fP \fIuser@domain.example\fP
[\fB\-ars\fP]
{\fIfolder_spec\fP|\fBf\fP\fIfolder_id\fP|[\fIfolder_id\fP\fB:\fP]\fImessage_id\fP}... >file.mt
.PP
\fBgromox\-exm2tnef \-u\fP \fIuser@domain.example\fP
[\fIfolder_id\fP\fB:\fP]\fImessage_id\fP >file.tnef
.SH Description
gromox-export reads folders or messages from an exmdb information store and
exports it in various formats. depending on which name it was invoked with.
("exm" is short for exmdb and refers to the network protocol used to talk to
the message store.) Multiple messages may only be exported to GXMT. ACLs are
not extracted yet. Export to PST is not possible: the external library libpff
has only implemented reading.
.PP
Folders can be selected by symbolic name or by folder path
(see gromox\-mbop(8) section "Folder specification" for that).
To select a folder by numeric ID, use the f prefix, e.g. \fBf13\fP or
\fBf0xd\fP.
To select a message by numeric ID, use the ID \fB262145\fP or \fB0x10001\fP.
The syntax \fB13:262145\fP reads a message using the Instance API (i.e. using a
copy-on-write object) and validates that the message is indeed in that folder;
this mode is only relevant for developers really.
.PP
An alternate way to get an EML representation is using grommunio-web's "Export
as > EML file(s)" function from the context menu of a mail item.
.SH Options
.TP
\fB\-\-ical\fP
Selects iCalendar (RFC 5545) as the output format. This is the default if the
program was invoked as gromox\-exm2ical.
.TP
\fB\-\-mail\fP
Selects Internet Mail (RFC 5322) as the output format. This is the default if
the program was invoked as gromox\-exm2eml.
.TP
\fB\-\-mt\fP
Selects Gromox Mailbox Transfer (GXMT) as the output format. This is the
default if the program was invoked as gromox\-export or gromox\-exm2mt.
.TP
\fB\-\-tnef\fP
Selects Transport Neutral Encapsulation Format (TNEF) as the output format.
This is the default if the program was invoked as gromox\-exm2tnef.
.TP
\fB\-\-vcard\fP
Selects vCard (RFC 6350) as the output format. This is the default if the
program was invoked as gromox\-exm2vcf.
.TP
\fB\-a\fP
Include Folder Associated Information (FAI), a.k.a. MAPI_ASSOCIATED messages in
the export as well. (PST export from Outlook would omit them; hence this is
also a separate option for gromox-export.)
.TP
\fB\-p\fP
Show properties in detail (enhances \fB\-t\fP).
.TP
\fB\-r\fP
Process folders recursively. (Only in conjunction with GXMT export.)
.TP
\fB\-s\fP
Mark objects for splicing when later imported. For example, objects exported
from, and originally located in Sent Items are, upon import, placed in the
target mailbox's Sent Items.
.TP
\fB\-t\fP
As the source message is read, print a diagnostic tree view of the MAPI
properties to stderr.
.TP
\fB\-u\fP [\fIuser\fP]\fB@\fIdomin.example\fP
Source mail store from which to load the message from. For the public folder of
a domain, leave out the local part, i.e. use \fB@\fP\fIdomain.example\fP.
.TP
\fB\-\-loglevel\fP \fIn\fP Maximum verbosity of general logging (not connected
to \fB\-p\fP, \fB\-t\fP or \fB\-v\fP). 1=crit, 2=error, 3=warn, 4=notice,
5=info, 6=debug.
.br
Default: \fI4\fP (notice)
.SH Examples
.IP \(bu 4
Export entire mailbox: gromox\-exm2mt \-u user@example.com \-ar / >dump.mt
.IP \(bu 4
Export most of the mailbox (as Outlook would): gromox\-exm2mt \-u u@e.xz \-r
IPM_SUBTREE >dump.mt
.IP \(bu 4
Export two folders without subordinates: gromox\-exm2mt \-u u@e.xz
IPM_SUBTREE/Foo IPM_SUBTREE/Bar >dump.mt
.IP \(bu 4
Export a single message as RFC5322: gromox\-exm2eml \-u u@e.xz 0x10001
>10001.eml
.IP \(bu 4
Export a MAPI contact as vcard: gromox\-exm2vcf \-u u@e.xz 0x30001 >30001.vcf
.SH See also
\fBgromox\fP(7), \fBgromox\-eml2mt\fP(8)
